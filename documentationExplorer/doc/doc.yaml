---
swagger: "2.0"

################################################################################
#                              API Information                                 #
################################################################################
info:
  version: "1.0"
  title: GreenAuto-Backend
  description: API
# during dev, should point to your local machine
host: "localhost:3000"
# basePath prefixes all resource paths
basePath: /v1
#
schemes:
  # tip: remove http to make production-grade
  - http
  - https
# format of bodies a client can send (Content-Type)
consumes:
  - application/json
# format of the responses to the client (Accepts)
produces:
  - application/json

################################################################################
#                                  Security                                    #
################################################################################

securityDefinitions:
  Bearer:
    type: apiKey
    name: Authorization
    in: header
    description: "Users login JWT with Bearer prefix. Example: Bearer <JWT>"

################################################################################
#                                           Paths                              #
################################################################################

paths:
  ##USERS
  /users/signup:
    post:
      security:
        - Bearer: []
      tags:
        - User
      summary: Add new user.
      description: "Requires logged in user to be menadzer or super_user."
      operationId: signUp
      consumes:
        - application/json
      produces:
        - application/json
      parameters:
        - in: body
          name: body
          description: User object that needs to be added to the users.
          required: true
          schema:
            $ref: "#/definitions/UsersSignUpBody"
      responses:
        "201":
          description: User signed up.
          schema:
            $ref: "#/definitions/UsersSignUpResponse"


  /users/signin:
    post:
      tags:
        - User
      summary: Sign in.
      description: "Sign in."
      operationId: signIn
      consumes:
        - application/json
      produces:
        - application/json
      parameters:
        - in: body
          name: body
          description: User credentials for sign in.
          required: true
          schema:
            $ref: "#/definitions/UsersSignInBody"
      responses:
        "201":
          description: User signed up.
          schema:
            $ref: "#/definitions/UsersSignUpResponse"

  /users/refresh_token:
    get:
      security:
        - Bearer: []
      tags:
        - User
      summary: Refresh login token..
      description: "Gets new login token."
      operationId: refreshToken
      consumes:
        - application/json
      produces:
        - application/json
      responses:
        "200":
          description: User signed up.
          schema:
            $ref: "#/definitions/UsersSignUpResponse"

  /users:
    get:
      security:
        - Bearer: []
      tags:
        - User
      summary: Get all users.
      operationId: getUsers
      consumes:
        - application/json
      produces:
        - application/json
      responses:
        "200":
          description: All users.
          schema:
            $ref: "#/definitions/UsersResponse"

  /users/{id}:
    get:
      security:
        - Bearer: []
      tags:
        - User
      summary: Get all users.
      operationId: getUsers
      consumes:
        - application/json
      produces:
        - application/json
      parameters:
        - in: path
          name: id
          description: ID of the user that needs to be updated
          required: true
          type: string
      responses:
        "200":
          description: All users.
          schema:
            $ref: "#/definitions/DeleteUsersResponse"
    put:
      security:
        - Bearer: []
      tags:
        - User
      summary: Update user.
      description: "Requires logged in user to be super_user."
      operationId: updateUser
      consumes:
        - application/json
      produces:
        - application/json
      parameters:
        - in: path
          name: id
          description: ID of the user that needs to be updated
          required: true
          type: string
        - in: body
          name: body
          description: Attributes and values that will be updated.
          required: true
          schema:
            $ref: "#/definitions/PutUsersBody"
      responses:
        "200":
          description: User updated.
          schema:
            $ref: "#/definitions/DeleteUsersResponse"

    delete:
      security:
        - Bearer: []
      tags:
        - User
      summary: Delete user.
      description: "Requires logged in user to be super_user."
      operationId: deleteUser
      consumes:
        - application/json
      produces:
        - application/json
      parameters:
        - in: path
          name: id
          description: ID of the user that needs to be deleted.
          required: true
          type: string
      responses:
        "200":
          description: User deleted.
          schema:
            $ref: "#/definitions/DeleteUsersResponse"
########################################
#######POSLOVNICA
  /poslovnice:
    get:
      security:
        - Bearer: []
      tags:
        - Poslovnica
      summary: Get all poslovnice.
      description: "Requires logged in user to be super_user."
      operationId: getPoslovnice
      consumes:
        - application/json
      produces:
        - application/json
      responses:
        "200":
          description: All poslovnice.
          schema:
            $ref: "#/definitions/PoslovnicaResponse"
    post:
      security:
        - Bearer: []
      tags:
        - Poslovnica
      summary: Add new poslovnica.
      description: "Requires logged in user to be super_user."
      operationId: createPoslovnica
      consumes:
        - application/json
      produces:
        - application/json
      parameters:
        - in: body
          name: body
          description: Poslovnica object that needs to be added to the poslovnice.
          required: true
          schema:
            $ref: "#/definitions/PostPoslovniceBody"
      responses:
        "201":
          description: Poslovnica created.
          schema:
            $ref: "#/definitions/DeletePoslovniceResponse"
  /poslovnice/{id}:
    get:
      security:
        - Bearer: []
      tags:
        - Poslovnica
      summary: Get all poslovnice.
      description: "Requires logged in user to be super_user."
      operationId: getPoslovnica
      consumes:
        - application/json
      produces:
        - application/json
      parameters:
        - in: path
          name: id
          description: ID of the poslovnica
          required: true
          type: string
      responses:
        "200":
          description: All users.
          schema:
            $ref: "#/definitions/DeletePoslovniceResponse"
    put:
      security:
        - Bearer: []
      tags:
        - Poslovnica
      summary: Update poslovnica.
      description: "Requires logged in user to be super_user."
      operationId: updatePoslovnica
      consumes:
        - application/json
      produces:
        - application/json
      parameters:
        - in: path
          name: id
          description: ID of the poslovnica that needs to be updated
          required: true
          type: string
        - in: body
          name: body
          description: Attributes and values that will be updated.
          required: true
          schema:
            $ref: "#/definitions/PutPoslovniceBody"
      responses:
        "200":
          description: Poslovnica updated.
          schema:
            $ref: "#/definitions/DeletePoslovniceResponse"

    delete:
      security:
        - Bearer: []
      tags:
        - Poslovnica
      summary: Delete poslovnica.
      description: "Requires logged in user to be super_user."
      operationId: deleteUser
      consumes:
        - application/json
      produces:
        - application/json
      parameters:
        - in: path
          name: id
          description: ID of the poslovnica that needs to be deleted.
          required: true
          type: string
      responses:
        "200":
          description: Poslovnica deleted.
          schema:
            $ref: "#/definitions/DeletePoslovniceResponse"
########################################
#######OPSTINA
  /opstine:
    get:
      security:
        - Bearer: []
      tags:
        - Opstina
      summary: Get all opstine.
      description: "Requires logged in user to be super_user."
      operationId: getOpstine
      consumes:
        - application/json
      produces:
        - application/json
      responses:
        "200":
          description: All opstine.
          schema:
            $ref: "#/definitions/OpstinaResponse"
    post:
      security:
        - Bearer: []
      tags:
        - Opstina
      summary: Add new opstina.
      description: "Requires logged in user to be super_user."
      operationId: createOpstina
      consumes:
        - application/json
      produces:
        - application/json
      parameters:
        - in: body
          name: body
          description: Opstina object that needs to be added to the opstine.
          required: true
          schema:
            $ref: "#/definitions/PostOpstineBody"
      responses:
        "201":
          description: Opstina created.
          schema:
            $ref: "#/definitions/DeleteOpstineResponse"
  /opstine/{id}:
    get:
      security:
        - Bearer: []
      tags:
        - Opstina
      summary: Get opstina.
      description: "Requires logged in user to be super_user."
      operationId: getOpstina
      consumes:
        - application/json
      produces:
        - application/json
      parameters:
        - in: path
          name: id
          description: ID of the opstina
          required: true
          type: string
      responses:
        "200":
          description: All users.
          schema:
            $ref: "#/definitions/DeleteOpstineResponse"
    put:
      security:
        - Bearer: []
      tags:
        - Opstina
      summary: Update opstina.
      description: "Requires logged in user to be super_user."
      operationId: updateOpstina
      consumes:
        - application/json
      produces:
        - application/json
      parameters:
        - in: path
          name: id
          description: ID of the opstina that needs to be updated
          required: true
          type: string
        - in: body
          name: body
          description: Attributes and values that will be updated.
          required: true
          schema:
            $ref: "#/definitions/PutOpstineBody"
      responses:
        "200":
          description: Opstina updated.
          schema:
            $ref: "#/definitions/DeleteOpstineResponse"

    delete:
      security:
        - Bearer: []
      tags:
        - Opstina
      summary: Delete opstina.
      description: "Requires logged in user to be super_user."
      operationId: deleteUser
      consumes:
        - application/json
      produces:
        - application/json
      parameters:
        - in: path
          name: id
          description: ID of the opstina that needs to be deleted.
          required: true
          type: string
      responses:
        "200":
          description: Opstina deleted.
          schema:
            $ref: "#/definitions/DeleteOpstineResponse"

########################################
#######BOX
  /usluge:
    get:
      security:
        - Bearer: []
      tags:
        - Usluga
      summary: Get all usluge.
      description: "Requires logged in user to be manager."
      operationId: getUsluge
      consumes:
        - application/json
      produces:
        - application/json
      responses:
        "200":
          description: All usluge.
          schema:
            $ref: "#/definitions/UslugaResponse"
    post:
      security:
        - Bearer: []
      tags:
        - Usluga
      summary: Add new usluga.
      description: "Requires logged in user to be manager."
      operationId: createUsluga
      consumes:
        - application/json
      produces:
        - application/json
      parameters:
        - in: body
          name: body
          description: Usluga object that needs to be added to the usluge.
          required: true
          schema:
            $ref: "#/definitions/PostUslugeBody"
      responses:
        "201":
          description: Usluga created.
          schema:
            $ref: "#/definitions/UslugeResponse"
  /usluge/{id}:
    get:
      security:
        - Bearer: []
      tags:
        - Usluga
      summary: Get usluga.
      description: "Requires logged in user to be manager."
      operationId: getUsluga
      consumes:
        - application/json
      produces:
        - application/json
      parameters:
        - in: path
          name: id
          description: ID of the usluga
          required: true
          type: string
      responses:
        "200":
          description: All users.
          schema:
            $ref: "#/definitions/UslugeResponse"
    put:
      security:
        - Bearer: []
      tags:
        - Usluga
      summary: Update usluga.
      description: "Requires logged in user to be super_user."
      operationId: updateUsluga
      consumes:
        - application/json
      produces:
        - application/json
      parameters:
        - in: path
          name: id
          description: ID of the usluga that needs to be updated
          required: true
          type: string
        - in: body
          name: body
          description: Attributes and values that will be updated.
          required: true
          schema:
            $ref: "#/definitions/PutUslugeBody"
      responses:
        "200":
          description: Usluga updated.
          schema:
            $ref: "#/definitions/UslugeResponse"

    delete:
      security:
        - Bearer: []
      tags:
        - Usluga
      summary: Delete usluga.
      description: "Requires logged in user to be super_user."
      operationId: deleteUser
      consumes:
        - application/json
      produces:
        - application/json
      parameters:
        - in: path
          name: id
          description: ID of the usluga that needs to be deleted.
          required: true
          type: string
      responses:
        "200":
          description: Usluga deleted.
          schema:
            $ref: "#/definitions/UslugeResponse"
################################################################################
#                                 Definitions                                  #
################################################################################

definitions:
  #################################################
  #models
  User:
    type: object
    required:
      - id
      - username
      - ime
      - poslovnica
      - email
      - rola
      - createdAt
      - updatedAt
    properties:
      id:
        type: string
      username:
        type: string
      ime:
        type: string
      poslovnica:
        type: string
      email:
        type: string
      rola:
        type: string
        enum: ['korisnik', 'menadzer', 'super_user']
      createdAt:
        type: string
      updatedAt:
        type: string

  Poslovnica:
    type: object
    required:
      - id
      - ime
      - opstina
      - adresa
      - pib
      - matBr
      - ziro
      - telefon
      - email
      - createdAt
      - updatedAt
    properties:
      id:
        type: string
      ime:
        type: string
      opstina:
        type: integer
      adresa:
        type: string
      pib:
        type: string
      matBr:
        type: string
      ziro:
        type: string
      telefon:
        type: string
      email:
        type: string
      createdAt:
        type: string
      updatedAt:
        type: string

  Opstina:
    type: object
    required:
      - id
      - ime
      - createdAt
      - updatedAt
    properties:
      id:
        type: string
      ime:
        type: string
      createdAt:
        type: string
      updatedAt:
        type: string

  Usluga:
    type: object
    required:
      - id
      - naziv
      - poslovnica
      - opis
      - cena
      - createdAt
      - updatedAt
    properties:
      id:
        type: string
      naziv:
        type: string
      poslovnica:
        type: string
      opis:
        type: string
      cena:
        type: string
      createdAt:
        type: string
      updatedAt:
        type: string
  #################################################################
  #################################################################
  #params

  ######################
  #Users
  UsersSignUpBody:
    type: object
    required:
      - username
      - ime
      - poslovnica
      - password
      - email
    properties:
      username:
        type: string
      ime:
        type: string
      poslovnica:
        type: integer
      password:
        type: string
      email:
        type: string

  PutUsersBody:
    type: object
    properties:
      username:
        type: string
      ime:
        type: string
      password:
        type: string
      email:
        type: string

  UsersSignInBody:
    type: object
    required:
      - username
      - password
    properties:
      username:
        type: string
      password:
        type: string

  ###############
  #Poslovnica
  PutPoslovniceBody:
    type: object
    properties:
      ime:
        type: string
      adresa:
        type: string
      pib:
        type: string
      matBr:
        type: string
      ziro:
        type: string
      telefon:
        type: string
      email:
        type: string

  PostPoslovniceBody:
    type: object
    required:
      - ime
      - opstina
      - adresa
      - pib
      - matBr
      - ziro
      - telefon
      - email
    properties:
      ime:
        type: string
      opstina:
        type: integer
      adresa:
        type: string
      pib:
        type: string
      matBr:
        type: string
      ziro:
        type: string
      telefon:
        type: string
      email:
        type: string

  ###############
  #Opstina
  PutOpstineBody:
    type: object
    properties:
      ime:
        type: string

  PostOpstineBody:
    type: object
    required:
      - ime
    properties:
      ime:
        type: string

  ###############
  #Usluga
  PostUslugeBody:
    type: object
    required:
      - naziv
      - poslovnica
      - opis
      - cena
    properties:
      naziv:
        type: string
      poslovnica:
        type: string
      opis:
        type: string
      cena:
        type: string

  PutUslugeBody:
    type: object
    required:
      - naziv
      - opis
      - cena
    properties:
      naziv:
        type: string
      opis:
        type: string
      cena:
        type: string

  ###############################################################
  ###############################################################
  #responses

  ######################
  #Users
  UsersSignUpResponse:
    type: object
    required:
      - status
      - data
    properties:
      status:
        type: string
        enum: ['success']
      data:
        type: object
        properties:
          token:
            type: string
            description: "JWT"
          user:
            $ref: "#/definitions/User"
  UsersResponse:
    type: object
    required:
      - status
      - data
    properties:
      status:
        type: string
        enum: ['success']
      data:
        type: object
        required:
          - users
        properties:
          users:
            type: 'array'
            items:
              $ref: "#/definitions/User"

  DeleteUsersResponse:
    type: object
    required:
      - status
      - data
    properties:
      status:
        type: string
        enum: ['success']
      data:
        type: object
        required:
          - user
        properties:
          user:
            $ref: "#/definitions/User"

###################
#Poslovnica
  PoslovnicaResponse:
    type: object
    required:
      - status
      - data
    properties:
      status:
        type: string
        enum: ['success']
      data:
        type: object
        required:
          - poslovnice
        properties:
          poslovnice:
            type: 'array'
            items:
              $ref: "#/definitions/Poslovnica"

  DeletePoslovniceResponse:
    type: object
    required:
      - status
      - data
    properties:
      status:
        type: string
        enum: ['success']
      data:
        type: object
        required:
          - poslovnica
        properties:
          poslovnica:
            $ref: "#/definitions/Poslovnica"

###################
#Opstina
  OpstinaResponse:
    type: object
    required:
      - status
      - data
    properties:
      status:
        type: string
        enum: ['success']
      data:
        type: object
        required:
          - opstine
        properties:
          opstine:
            type: 'array'
            items:
              $ref: "#/definitions/Opstina"

  DeleteOpstineResponse:
    type: object
    required:
      - status
      - data
    properties:
      status:
        type: string
        enum: ['success']
      data:
        type: object
        required:
          - opstina
        properties:
          opstina:
            $ref: "#/definitions/Opstina"

###################
#Usluga
  UslugaResponse:
    type: object
    required:
      - status
      - data
    properties:
      status:
        type: string
        enum: ['success']
      data:
        type: object
        required:
          - usluge
        properties:
          usluge:
            type: 'array'
            items:
              $ref: "#/definitions/Usluga"

  UslugeResponse:
    type: object
    required:
      - status
      - data
    properties:
      status:
        type: string
        enum: ['success']
      data:
        type: object
        required:
          - usluga
        properties:
          usluga:
            $ref: "#/definitions/Usluga"
